let slideStartTime;let totalStartTime;let slideTimes = [];let timerInterval;let isPaused = false;let pausedTime = 0;const bellSound = document.getElementById('bellSound');function startTimer() {    if (!totalStartTime) { // 如果計時器是第一次開始        totalStartTime = new Date();        slideStartTime = new Date();    } else if (isPaused) { // 如果計時器是從暫停狀態恢復        const now = new Date();        const pauseDuration = now - pausedTime;        totalStartTime = new Date(totalStartTime.getTime() + pauseDuration);        slideStartTime = new Date(slideStartTime.getTime() + pauseDuration);        isPaused = false;    }    timerInterval = setInterval(updateTimer, 10); // 更新頻率為每10毫秒    document.getElementById('nextSlideBtn').disabled = false;    document.getElementById('startBtn').disabled = true;    document.getElementById('pauseBtn').disabled = false;}function pauseTimer() {    clearInterval(timerInterval);    isPaused = true;    pausedTime = new Date();    document.getElementById('startBtn').disabled = false;    document.getElementById('pauseBtn').disabled = true;}function updateTimer() {    const now = new Date();    const totalElapsedTime = now - totalStartTime;    const elapsedTime = now - slideStartTime;    // 計算分鐘、秒和毫秒    const minutes = String(Math.floor(totalElapsedTime / 60000)).padStart(2, '0');    const seconds = String(Math.floor((totalElapsedTime % 60000) / 1000)).padStart(2, '0');    const milliseconds = String(Math.floor((totalElapsedTime % 1000) / 10)).padStart(2, '0');    // 更新顯示的時間    document.getElementById('slideTimer').textContent = `${minutes}:${seconds}.${milliseconds}`;    // 在5分鐘和6分鐘時播放鈴聲    if (totalElapsedTime >= 300000 && totalElapsedTime < 300010) { // 5分鐘時播放一次鈴聲        bellSound.play();    }    if (totalElapsedTime >= 360000 && totalElapsedTime < 360010) { // 6分鐘時播放兩次鈴聲        bellSound.play();        setTimeout(() => bellSound.play(), 500); // 500毫秒後再播放一次    }}function nextSlide() {    const now = new Date();    const slideElapsedTime = now - slideStartTime;    const totalElapsedTime = now - totalStartTime;    // 記錄該投影片的時間和總時間    slideTimes.push({        slide: slideTimes.length,  // 這裡的 slideTimes.length 自然從 0 開始        time: slideElapsedTime,        totalTime: totalElapsedTime    });    updateStatistics();    // 重置投影片開始時間，但總時間繼續    slideStartTime = new Date();}function undoLastSlide() {    if (slideTimes.length === 0) return; // 如果還沒有記錄投影片時間，直接返回    const now = new Date();    const correctTime = now - slideStartTime;    // 修正最後一張投影片的時間    slideTimes[slideTimes.length - 1].time += correctTime;    slideTimes[slideTimes.length - 1].totalTime += correctTime;    updateStatistics();    // 重置投影片開始時間，以便繼續計時    slideStartTime = new Date();}function updateStatistics() {    const statisticsList = document.getElementById('statisticsList');    statisticsList.innerHTML = '';    slideTimes.forEach((slideData) => {        const minutes = String(Math.floor(slideData.time / 60000)).padStart(2, '0');        const seconds = String(Math.floor((slideData.time % 60000) / 1000)).padStart(2, '0');        const milliseconds = String(Math.floor((slideData.time % 1000) / 10)).padStart(2, '0');        const totalMinutes = String(Math.floor(slideData.totalTime / 60000)).padStart(2, '0');        const totalSeconds = String(Math.floor((slideData.totalTime % 60000) / 1000)).padStart(2, '0');        const totalMilliseconds = String(Math.floor((slideData.totalTime % 1000) / 10)).padStart(2, '0');        const row = `<tr>            <td>${slideData.slide}</td>            <td>${minutes}:${seconds}.${milliseconds}</td>            <td>${totalMinutes}:${totalSeconds}.${totalMilliseconds}</td>        </tr>`;        statisticsList.insertAdjacentHTML('beforeend', row);    });}function sortTable(n) {    const table = document.getElementById("statisticsTable");    let switching = true;    let shouldSwitch, i;    let dir = "asc";     let switchCount = 0;        while (switching) {        switching = false;        const rows = table.rows;        for (i = 1; i < (rows.length - 1); i++) {            shouldSwitch = false;            const x = rows[i].getElementsByTagName("TD")[n];            const y = rows[i + 1].getElementsByTagName("TD")[n];            if (dir === "asc") {                if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {                    shouldSwitch = true;                    break;                }            } else if (dir === "desc") {                if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {                    shouldSwitch = true;                    break;                }            }        }        if (shouldSwitch) {            rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);            switching = true;            switchCount++;        } else {            if (switchCount === 0 && dir === "asc") {                dir = "desc";                switching = true;            }        }    }}document.getElementById('startBtn').addEventListener('click', startTimer);document.getElementById('pauseBtn').addEventListener('click', pauseTimer);document.getElementById('nextSlideBtn').addEventListener('click', nextSlide);document.getElementById('undoBtn').addEventListener('click', undoLastSlide);